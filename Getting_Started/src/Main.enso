from Standard.Base import all
from Standard.Table import all
import Standard.Visualization

## # Welcome to Enso Analytics!![Testing](https://www.youtube.com/embed/4y_oCSBzctE) 
   ### Connect the **2025 Results** worksheet to the **right** argument on the join component, as shown below.
   ![reconnect_join](/images/reconnect_join.gif)



   - How did the organisation do against its targets for 2025?
   - The only change to the workflow was just a change in input data! All other logic is repeatable!
   - No need to hit a run button. Enso recalculated the results automatically!

   ## 
   What if we adjust the targets? Change the 2000 on the set component labelled "Adjust Targets" to 500. Now which quarters met their targets?

   # Next Steps
   1. Check out [Getting Started](<https://community.ensoanalytics.com/c/start-here/>) on the Enso Community!
   2. There you will find a self-paced course [Enso Analytics 101](<https://community.ensoanalytics.com/c/enso-analytics-101/>) which will quickly get you **prepping, blending, analyzing** and **automating** in Enso Analytics.
main =
    file1 = Data.read 'Data/Sales Targets and Results.xlsx'
    targets = file1.read 'Targets'
    results_2024 = file1.read '2024 Results'
    results_2025 = file1.read '2025 Results'
    table1 = targets.join results_2025 ..Inner [(..Equals 'Quarter')]
    ## Adjust Targets 
    any2 = table1.set (..Simple_Expr (..Name 'Target') (..Add 2000)) set_mode=..Update
    any1 = any2.set (expr 'IF [Sales]>[Target] THEN "✅" ELSE "❌"') "Met Target"
    table4 = any1.select_columns ['Met Target', 'Year', 'Quarter', 'Target', 'Sales'] True



#### METADATA ####
[[{"index":{"value":1108},"size":{"value":47}},"e6ceb127-ec28-4485-ba0c-948e11c8d2c4"],[{"index":{"value":1170},"size":{"value":20}},"3de01645-421f-437a-92de-0059bb62a22b"],[{"index":{"value":1210},"size":{"value":25}},"01f10de1-4929-4332-8c8f-778806e09bfe"],[{"index":{"value":1255},"size":{"value":10}},"1572bfae-0da2-4bdf-90a9-a9a262e1ffdb"],[{"index":{"value":1255},"size":{"value":25}},"7ee2878c-5a99-4329-8b5d-dcce30c3dbda"],[{"index":{"value":1294},"size":{"value":12}},"56f450ad-fa57-40c5-bd42-32eba125f97a"],[{"index":{"value":1294},"size":{"value":33}},"337e6cde-a406-4294-b3b3-43cc97165865"],[{"index":{"value":1294},"size":{"value":56}},"cc7954e1-67c6-4cc5-87fc-9b5d035a0c5a"],[{"index":{"value":1385},"size":{"value":10}},"8e13e568-00e2-434e-aaa3-5d8b24cd4f0d"],[{"index":{"value":1385},"size":{"value":57}},"0bf392cd-cba2-473c-b2f1-abc435041642"],[{"index":{"value":1385},"size":{"value":75}},"a0d6d82f-8d38-4286-97f3-89ebd8aeab79"],[{"index":{"value":1472},"size":{"value":8}},"e5ee3900-7091-4545-99ce-5e9f463e3632"],[{"index":{"value":1472},"size":{"value":55}},"6e3626f6-7479-4665-86d8-70545a34c943"],[{"index":{"value":1472},"size":{"value":68}},"5d7e1b11-d48f-4ad4-87f6-6ace245735f9"],[{"index":{"value":1554},"size":{"value":19}},"21e7d2c8-c826-456e-ae1f-ff11c488606f"],[{"index":{"value":1554},"size":{"value":72}},"651e37c0-2c4d-445a-b3f6-4860fa7d4eda"],[{"index":{"value":1554},"size":{"value":77}},"a80772a0-b804-4230-a880-de9644b7f649"]]
{"ide":{"node":{"e6ceb127-ec28-4485-ba0c-948e11c8d2c4":{"position":{"vector":[-488,756]}},"3de01645-421f-437a-92de-0059bb62a22b":{"position":{"vector":[-488,654]},"visualization":{"show":false,"width":964.06640625,"height":360.83203125,"project":{"project":"Builtin"},"name":"Table"}},"01f10de1-4929-4332-8c8f-778806e09bfe":{"position":{"vector":[-286,616]},"visualization":{"show":false,"width":785.317138671875}},"7ee2878c-5a99-4329-8b5d-dcce30c3dbda":{"position":{"vector":[-77,562]}},"1572bfae-0da2-4bdf-90a9-a9a262e1ffdb":{"position":{"vector":[-46,391]}},"cc7954e1-67c6-4cc5-87fc-9b5d035a0c5a":{"position":{"vector":[-488,449]}},"337e6cde-a406-4294-b3b3-43cc97165865":{"position":{"vector":[-404,271]}},"56f450ad-fa57-40c5-bd42-32eba125f97a":{"position":{"vector":[-404,219]}},"a0d6d82f-8d38-4286-97f3-89ebd8aeab79":{"position":{"vector":[-488,377]}},"0bf392cd-cba2-473c-b2f1-abc435041642":{"position":{"vector":[-359,196]}},"8e13e568-00e2-434e-aaa3-5d8b24cd4f0d":{"position":{"vector":[-361,196]}},"5d7e1b11-d48f-4ad4-87f6-6ace245735f9":{"position":{"vector":[-488,305]}},"6e3626f6-7479-4665-86d8-70545a34c943":{"position":{"vector":[-404,197]},"visualization":{"show":true}},"e5ee3900-7091-4545-99ce-5e9f463e3632":{"position":{"vector":[97,197]}},"a80772a0-b804-4230-a880-de9644b7f649":{"position":{"vector":[-488,233]},"visualization":{"show":true,"width":766.9431456564862,"height":224.4805321400059}},"651e37c0-2c4d-445a-b3f6-4860fa7d4eda":{"position":{"vector":[-404,196]}},"21e7d2c8-c826-456e-ae1f-ff11c488606f":{"position":{"vector":[-404,196]}}},"widget":{},"snapshot":"eJyNVMtu4zYU3fsrju2FYiOmH0g2RTODTOp2BmgNTON2UBiGcS1dS5xQpEJSUJx9d/2E6c/NlxSkrASe2XQl6vLcc8998WBNiXtPOiObiXfkGLKsjPUgpXqHs9s17dXZ9en4AvhTupqUfCYvje71hkMM8YlVakqGN1hqZ3CrSR29TF2/v1mz81Ln24vC+8r9MJ02TSOOpvb1nkVqyimXe86mV8edubt/95z65Qg9AMPhEHdGa049fMEYjxezxTV+Z1cr78ZjNMY+uILZh7Atwsq88OMxyOZ1ydrD6Hjz2UiN1JSV0az9JcjBFabR2LMyjQjh+hvLaRtuF+Dbi6ksKWc3PbeLXB5GvV4v+Ezw3jTIZBaDGJuTli7WBZkB5SS185DewZPN2TscjEVI423rvg5uWh2RFqRz7hIJmR2UadCQw+faeVCHkBpSV7VHRp76uFUKxhdsoUwuU0gHyxWTD13st0FWBpo5C+SFDFS21tjX3hst2nZZTkmltSLPbSq2LTKo9qYkL1NS6tjvtW2J3flUkIc8oGFQFiUGv1Oab3F3yqdgLGazWdcHx/61DVC0Z6U4w+C2pVi37oMg9Xo2E1iFGhQyLfBYk/VsHUqOoaR9CdbKwoqfwpRy5cL/XOCu4PQBpvbY/MI+zGAYYus521782A1jasqy1tIfBWtnqJvbOJjp1AX8pGDL0zejLolYsrvOLxZ5IUIrLeNoajRSKRykzkBwrA6TilLOkJraOsbmfEEwn83/t5xgm7wYJ/PZPMhqCxSjPtYyfVBH5OyjlPG4slxVUueX2CvWWTxFhmep87ApOsN43PU5mqT+ZolFrySpcRMyxUEqnuMGP5EnYZkyJOE4vSfFrutgpD1tqnhS7imJvt0W3LQsJ/eTTws5Td5uMVtcfYOLphPpd+Dr78HX5+C4EkH5SYWIj8IZhRAftGaLzYUQy8ealEPysR28ZLSNLMMhzoc1bgNIHxeROsQQYcwvhLiXZaV4t3yqbPhdUcldtskoWG6zLK7HaBQ2Y1eajG+E+KPKyHNHGxQH9paUA1fy4WdsYr23bzYt3xbr98sVBl+//D3A8tf7JQZf//1nkIww+I07rYPXOly1rEGqCi9balRdaodN8gpPLpH8xWTDt6vC5UsCl0iihGSLta259x+7bxup","import":{}}}